<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Session 10: Repeated Measures and Longitudinal Analysis I • session10</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Session 10: Repeated Measures and Longitudinal Analysis I">
<meta property="og:description" content="session10">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-176789980-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176789980-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">session10</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lecture and Lab
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/session_lecture.html">Lecture notes</a>
    </li>
    <li>
      <a href="../articles/session_lecture.pdf">Lecture notes PDF</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/session_lab.html">Lab materials</a>
    </li>
  </ul>
</li>
<li class="dropdown-header">
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronbios2/session10/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/leviwaldron1">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="session_lecture_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Session 10: Repeated Measures and Longitudinal Analysis I</h1>
                        <h4 class="author">Levi Waldron</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronbios2/session10/blob/master/vignettes/session_lecture.Rmd"><code>vignettes/session_lecture.Rmd</code></a></small>
      <div class="hidden name"><code>session_lecture.Rmd</code></div>

    </div>

    
    
<div id="learning-objectives-and-outline" class="section level1">
<h1 class="hasAnchor">
<a href="#learning-objectives-and-outline" class="anchor"></a>Learning objectives and outline</h1>
<div id="learning-objectives" class="section level2">
<h2 class="hasAnchor">
<a href="#learning-objectives" class="anchor"></a>Learning objectives</h2>
<ol style="list-style-type: decimal">
<li>Define mixed effects models and population average models</li>
<li>Perform model diagnostics for random effects models</li>
<li>Interpret random intercepts and random slopes</li>
<li>Define and perform population average models</li>
<li>Define assumptions on correlation structure in hierarchical models</li>
<li>Choose between hierarchical modeling strategies</li>
</ol>
</div>
<div id="outline" class="section level2">
<h2 class="hasAnchor">
<a href="#outline" class="anchor"></a>Outline</h2>
<ol style="list-style-type: decimal">
<li>Review of fecal fat dataset</li>
<li>Summary of non-hierarchical approaches</li>
<li>Mixed effects models</li>
<li>Longitudinal data and the Georgia Birthweights dataset</li>
<li>Population average models and Generalized Estimating Equations (GEE)</li>
</ol>
<ul>
<li>Vittinghoff sections 7.2, 7.3, 7.5</li>
</ul>
</div>
</div>
<div id="review" class="section level1">
<h1 class="hasAnchor">
<a href="#review" class="anchor"></a>Review</h1>
<div id="fecal-fat-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#fecal-fat-dataset" class="anchor"></a>Fecal fat dataset</h2>
<ul>
<li>Lack of digestive enzymes in the intestine can cause bowel absorption problems.
<ul>
<li>This will be indicated by excess fat in the feces.</li>
<li>Pancreatic enzyme supplements can alleviate the problem.</li>
<li>fecfat.csv: a study of fecal fat quantity (g/day) for individuals given each of a placebo and 3 types of pills</li>
</ul>
</li>
</ul>
<div class="figure">
<img src="VittinghoffTable71.png" alt=""><p class="caption">Fecal Fat dataset</p>
</div>
</div>
<div id="fecal-fat-dataset-1" class="section level2">
<h2 class="hasAnchor">
<a href="#fecal-fat-dataset-1" class="anchor"></a>Fecal fat dataset</h2>
<p><img src="session_lecture_files/figure-html/boxplot-1.png" width="700"></p>
</div>
<div id="analysis-strategies-for-hierarchical-data" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-strategies-for-hierarchical-data" class="anchor"></a>Analysis strategies for hierarchical data</h2>
<ul>
<li>Fixed effects and other non-hierarchical strategies</li>
<li>Random / mixed effects models
<ul>
<li>model certain regression coefficients (intercept, slopes) as random variables</li>
</ul>
</li>
<li>Population average models
<ul>
<li>using Generalized Estimating Equations (GEE)</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="non-hierarchical-analysis-strategies" class="section level1">
<h1 class="hasAnchor">
<a href="#non-hierarchical-analysis-strategies" class="anchor"></a>Non-hierarchical analysis strategies</h1>
<div id="non-hierarchical-analysis-strategies-for-hierarchical-data" class="section level2">
<h2 class="hasAnchor">
<a href="#non-hierarchical-analysis-strategies-for-hierarchical-data" class="anchor"></a>Non-hierarchical analysis strategies for hierarchical data</h2>
<ul>
<li>Analyses for each subgroup
<ul>
<li>e.g., look at each patient independently</li>
<li>doesn’t work at all in this example, and in general is not an integrated analysis of the whole data</li>
<li>could sort of work for an example with many patients per doctor, a few doctors</li>
</ul>
</li>
<li>Analysis at the highest level in the hierarchy
<ul>
<li>first summarize data to highest level</li>
<li>doesn’t work at all in this example</li>
<li>could sort of work for an example with few patients per doctor, many doctors</li>
</ul>
</li>
<li>Analysis on “Derived Variables”
<ul>
<li>consider each treatment type separately, take differences in fat levels between treatment/control for each patient and use paired t-tests</li>
<li>can work, but not for unbalanced groups</li>
</ul>
</li>
<li>Fixed-effects models</li>
</ul>
</div>
<div id="when-is-hierarchical-analysis-definitely-needed" class="section level2">
<h2 class="hasAnchor">
<a href="#when-is-hierarchical-analysis-definitely-needed" class="anchor"></a>When is hierarchical analysis definitely needed?</h2>
<ol style="list-style-type: decimal">
<li>the correlation structure is of interest, <em>e.g.</em> familial aggregation of disease, or consistency of treatment within centers</li>
<li>we wish to “borrow strength” across the levels of a hierarchy in order to improve estimates</li>
<li>dealing with unbalanced data</li>
<li>we want to benefit from software designed for hierarchical data</li>
</ol>
</div>
</div>
<div id="mixed-effects-models" class="section level1">
<h1 class="hasAnchor">
<a href="#mixed-effects-models" class="anchor"></a>Mixed effects models</h1>
<div id="mixed-effects-models-1" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-effects-models-1" class="anchor"></a>Mixed effects models</h2>
<ul>
<li>Model looks like two-way ANOVA: <span class="math display">\[
FECFAT_{ij} = \beta_0 + \beta_{subject i} SUBJECT_i + \beta_{pilltype j} PILLTYPE_j + \epsilon_{ij}
\]</span>
<ul>
<li>Assumption: <span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma_\epsilon^2)\)</span>
</li>
</ul>
</li>
<li>But instead of fitting a <span class="math inline">\(\beta\)</span> to each individual, we assume that the subject effects are selected from a distribution of possible subject effects: <span class="math display">\[
FECFAT_{ij} = \beta_0 + SUBJECT_i + \beta_{pilltype j} PILLTYPE_j + \epsilon_{ij}
\]</span>
</li>
</ul>
<p>Where we assume: <span class="math inline">\(SUBJECT_i \stackrel{iid}{\sim} N(0, \tau_{00}^2)\)</span></p>
<ul>
<li>This is a <em>mixed effects</em> model because:
<ul>
<li>the “true” intercept varies randomly from patient to patient</li>
<li>the “true” (population) coefficient of treatment is fixed (the same for everyone)</li>
</ul>
</li>
</ul>
</div>
<div id="mixed-effects-model-coeffients-variances-icc" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-effects-model-coeffients-variances-icc" class="anchor"></a>Mixed effects model coeffients, variances, ICC</h2>

<pre><code>## Linear mixed-effects model fit by REML
##   Data: dat 
##   Log-restricted-likelihood: -84.55594
##   Fixed: fecfat ~ pilltype 
##     (Intercept)  pilltypetablet pilltypecapsule  pilltypecoated 
##       38.083334      -21.550001      -20.666667       -7.016668 
## 
## Random effects:
##  Formula: ~1 | subject
##         (Intercept) Residual
## StdDev:    15.89557 10.34403
## 
## Number of Observations: 24
## Number of Groups: 6</code></pre>
<p><span class="math inline">\(ICC = 15.9^2 / (15.9^2 + 10.34^2)\)</span> = 0.7 = 0.7.</p>

<ul>
<li>Recall ICC is a measure of how large the subject effect is, in relation to the error term</li>
<li>Variances were estimated directly by the model!</li>
</ul>
</div>
<div id="assumptions-of-the-mixed-model" class="section level2">
<h2 class="hasAnchor">
<a href="#assumptions-of-the-mixed-model" class="anchor"></a>Assumptions of the mixed model</h2>
<p><span class="math display">\[
FECFAT_{ij} = \beta_0 + SUBJECT_i + \beta_{pilltype j} PILLTYPE_j + \epsilon_{ij}
\]</span></p>
<ul>
<li>Normally distributed residuals as in fixed effects model:
<ul>
<li><span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma_\epsilon^2)\)</span></li>
</ul>
</li>
<li>Normally distributed <strong>latent variable</strong>:
<ul>
<li><span class="math inline">\(SUBJECT_i \stackrel{iid}{\sim} N(0, \tau_{00}^2)\)</span></li>
</ul>
</li>
</ul>
</div>
<div id="mixed-effects-model-results" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-effects-model-results" class="anchor"></a>Mixed effects model results</h2>
<p>A plot of the random intercept: <img src="session_lecture_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="mixed-effects-model-diagnostics" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-effects-model-diagnostics" class="anchor"></a>Mixed effects model diagnostics</h2>
<p><img src="session_lecture_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="mixed-effects-model-results-1" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-effects-model-results-1" class="anchor"></a>Mixed effects model results</h2>

<pre><code>## Linear mixed-effects model fit by REML
##  Data: dat 
##        AIC      BIC    logLik
##   181.1119 187.0863 -84.55594
## 
## Random effects:
##  Formula: ~1 | subject
##         (Intercept) Residual
## StdDev:    15.89557 10.34403
## 
## Fixed effects: fecfat ~ pilltype 
##                     Value Std.Error DF   t-value p-value
## (Intercept)      38.08333  7.742396 15  4.918805  0.0002
## pilltypetablet  -21.55000  5.972127 15 -3.608430  0.0026
## pilltypecapsule -20.66667  5.972127 15 -3.460521  0.0035
## pilltypecoated   -7.01667  5.972127 15 -1.174903  0.2583
##  Correlation: 
##                 (Intr) plltypt plltypcp
## pilltypetablet  -0.386                 
## pilltypecapsule -0.386  0.500          
## pilltypecoated  -0.386  0.500   0.500  
## 
## Standardized Within-Group Residuals:
##          Min           Q1          Med           Q3          Max 
## -1.210052934 -0.615068039 -0.002727166  0.457105344  1.725618643 
## 
## Number of Observations: 24
## Number of Groups: 6</code></pre>

<ul>
<li>Note: correlation of the estimator of the fixed effects
<ul>
<li>high correlations may (but not necessarily) be due to collinearity</li>
<li>not usually useful, not included in output of some packages</li>
</ul>
</li>
</ul>
</div>
<div id="mixed-effects-model-results-2" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-effects-model-results-2" class="anchor"></a>Mixed effects model results</h2>
<p>Inference for variance terms (and fixed effects): </p>
<pre><code>## Approximate 95% confidence intervals
## 
##  Fixed effects:
##                     lower       est.     upper
## (Intercept)      21.58081  38.083334 54.585860
## pilltypetablet  -34.27929 -21.550001 -8.820714
## pilltypecapsule -33.39595 -20.666667 -7.937381
## pilltypecoated  -19.74595  -7.016668  5.712618
## attr(,"label")
## [1] "Fixed effects:"
## 
##  Random Effects:
##   Level: subject 
##                   lower     est.    upper
## sd((Intercept)) 8.00117 15.89557 31.57904
## 
##  Within-group standard error:
##    lower     est.    upper 
##  7.23240 10.34403 14.79438</code></pre>

<ul>
<li>Would conclude that variation of the intercept between subjects is non-zero
<ul>
<li>not attributable to within-subject variation</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="longitudinal-data" class="section level1">
<h1 class="hasAnchor">
<a href="#longitudinal-data" class="anchor"></a>Longitudinal data</h1>
<div id="longitudinal-data-1" class="section level2">
<h2 class="hasAnchor">
<a href="#longitudinal-data-1" class="anchor"></a>Longitudinal data</h2>
<ul>
<li>Interested in the change in the value of a variable within a “subject”</li>
<li>Collect data repeatedly through time.</li>
<li>For hierarchical longitudinal analysis to be effective, before/after measurements need to be positively correlated</li>
</ul>
</div>
<div id="longitudinal-data-2" class="section level2">
<h2 class="hasAnchor">
<a href="#longitudinal-data-2" class="anchor"></a>Longitudinal data</h2>
<ul>
<li>Interested in the change in the value of a variable within a “subject”</li>
<li>Collect data repeatedly through time.</li>
<li>For hierarchical longitudinal analysis to be effective, before/after measurements need to be positively correlated</li>
</ul>
</div>
<div id="longitudinal-data-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#longitudinal-data-examples" class="anchor"></a>Longitudinal data examples</h2>
<ul>
<li>Example 1: a measure of sleepiness before and after administration of treatment or placebo</li>
<li>Example 2: Study of Osteoporotic Fractores (SOF dataset)
<ul>
<li>9,704 women tracked with clinical visits every two years</li>
<li>Bone Mineral Density (BMD), Body Mass Index (BMI), many other variables</li>
</ul>
</li>
<li>Questions for Example 2:
<ol style="list-style-type: decimal">
<li>Is change in BMD related to age at menopause? This is a time-invariant predictor, age at menopause, with time-dependent changes in the outcome, BMD.</li>
<li>Is change in BMD related to change in BMI? This is an analysis relating a time-varying predictor, BMI, with changes in the outcome, BMD. BMI varies quite a lot between women, but also varies within a woman over time.</li>
</ol>
</li>
</ul>
</div>
<div id="longitudinal-data-examples-1" class="section level2">
<h2 class="hasAnchor">
<a href="#longitudinal-data-examples-1" class="anchor"></a>Longitudinal data examples</h2>
<ul>
<li>birthweight and birth order</li>
<li>provides birthweights and order of infants from mothers who had 5 children in Georgia
<ul>
<li>interested in whether birthweight of babies changes with order</li>
<li>whether this difference depends on the <em>mother’s age at first childbirth</em> or on the <em>weight of initial baby</em>.</li>
</ul>
</li>
</ul>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   momid = col_double(),
##   birthord = col_double(),
##   momage = col_double(),
##   timesnc = col_double(),
##   lowbrth = col_double(),
##   bweight = col_double(),
##   delwght = col_double(),
##   lastwght = col_double(),
##   initage = col_double(),
##   initwght = col_double(),
##   cinitage = col_double()
## )</code></pre>
</div>
<div id="georgia-birthweights-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#georgia-birthweights-dataset" class="anchor"></a>Georgia Birthweights dataset</h2>
<p>“Spaghetti” plot: <img src="session_lecture_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="georgia-birthweights-dataset-1" class="section level2">
<h2 class="hasAnchor">
<a href="#georgia-birthweights-dataset-1" class="anchor"></a>Georgia Birthweights dataset</h2>
<ul>
<li>Do birth weights or the effect of birth order vary by mother?
<ul>
<li>random intercept, random slope</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">gafit1</span> <span class="op">&lt;-</span> <span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span><span class="va">bweight</span> <span class="op">~</span> <span class="va">birthord</span>, data<span class="op">=</span><span class="va">ga</span>, 
    random<span class="op">=</span><span class="op">~</span><span class="va">birthord</span><span class="op">|</span><span class="va">momid</span>,
    na.action<span class="op">=</span><span class="va">na.omit</span>,
    control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>msMaxIter<span class="op">=</span><span class="fl">600</span>, msMaxEval<span class="op">=</span><span class="fl">600</span>, 
                 sing.tol<span class="op">=</span><span class="fl">1e-20</span>, msVerbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>  </pre></div>
<p>Note: the control argument increases the max # iterations to allow convergence. If <code>msVerbose=TRUE</code>, it produces verbose output.</p>
</div>
<div id="georgia-birthweights-dataset-2" class="section level2">
<h2 class="hasAnchor">
<a href="#georgia-birthweights-dataset-2" class="anchor"></a>Georgia Birthweights dataset</h2>
<p><img src="session_lecture_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="georgia-birthweights-dataset-3" class="section level2">
<h2 class="hasAnchor">
<a href="#georgia-birthweights-dataset-3" class="anchor"></a>Georgia Birthweights dataset</h2>

<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gafit1</span><span class="op">)</span></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##  Data: ga 
##        AIC      BIC    logLik
##   15321.23 15350.67 -7654.616
## 
## Random effects:
##  Formula: ~birthord | momid
##  Structure: General positive-definite, Log-Cholesky parametrization
##             StdDev    Corr  
## (Intercept) 296.40072 (Intr)
## birthord     23.87215 0.993 
## Residual    443.43168       
## 
## Fixed effects: bweight ~ birthord 
##                Value Std.Error  DF  t-value p-value
## (Intercept) 2995.640  38.99668 799 76.81782       0
## birthord      46.608  10.05809 799  4.63388       0
##  Correlation: 
##          (Intr)
## birthord -0.662
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -5.32827381 -0.42194068  0.04103172  0.53116958  3.25527629 
## 
## Number of Observations: 1000
## Number of Groups: 200</code></pre>
</div>
<div id="georgia-birthweights-dataset-4" class="section level2">
<h2 class="hasAnchor">
<a href="#georgia-birthweights-dataset-4" class="anchor"></a>Georgia Birthweights dataset</h2>

<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu">intervals</span><span class="op">(</span><span class="va">gafit1</span>, which <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></pre></div>
<pre><code>## Approximate 95% confidence intervals
## 
##  Fixed effects:
##                  lower     est.      upper
## (Intercept) 2919.09196 2995.640 3072.18804
## birthord      26.86459   46.608   66.35141
## attr(,"label")
## [1] "Fixed effects:"</code></pre>

<ul>
<li>Do birth weights or the effect of birth order vary by mother?
<ul>
<li>yes: both standard deviations are non-zero</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="population-average-models" class="section level1">
<h1 class="hasAnchor">
<a href="#population-average-models" class="anchor"></a>Population Average Models</h1>
<div id="population-average-models-1" class="section level2">
<h2 class="hasAnchor">
<a href="#population-average-models-1" class="anchor"></a>Population Average Models</h2>
<ul>
<li>An alternative to random / mixed-effects models that is more robust to assumptions of:
<ul>
<li>distribution of random effects</li>
<li>correlation structure</li>
</ul>
</li>
<li>Estimates correlation structure from the data rather than assuming normality
<ul>
<li>Requires a fair bit more clusters than observations per cluster</li>
</ul>
</li>
<li>Estimates regression coefficients and robust standard errors
<ul>
<li>commonly by Generalized Estimating Equations (GEE)</li>
</ul>
</li>
</ul>
</div>
<div id="population-average-models-2" class="section level2">
<h2 class="hasAnchor">
<a href="#population-average-models-2" class="anchor"></a>Population Average Models</h2>
<ul>
<li><p>Compare mixed model multiple linear regression: <span class="math display">\[
E[Y_{ij}|X_{ij}] = \beta_0 + \alpha_{0j} + \beta_1 X_{ij}, \alpha_{0j} \sim N(0, \sigma)
\]</span> for subject <span class="math inline">\(i\)</span> in group <span class="math inline">\(j\)</span>.</p></li>
<li><p>to a population average model: <span class="math display">\[
E[Y_{ij}|X_{ij}] = \beta_0^* + \beta_1^* X_{ij}
\]</span></p></li>
<li><p>Interpretations of <span class="math inline">\(\beta^*\)</span> and <span class="math inline">\(\beta\)</span> are equivalent</p></li>
<li><p>Numerically equivalent for linear and log-linear models (if specification of mixed model is correct), but not for logistic link.</p></li>
</ul>
</div>
<div id="fit-a-population-average-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-a-population-average-model" class="anchor"></a>Fit a population average model</h2>

<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">gafit.gee</span> <span class="op">&lt;-</span> <span class="fu">gee</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gee/man/gee.html">gee</a></span><span class="op">(</span><span class="va">bweight</span> <span class="op">~</span> <span class="va">birthord</span>,
                      corstr <span class="op">=</span> <span class="st">"exchangeable"</span>,
                      id <span class="op">=</span> <span class="va">momid</span>,
                      data <span class="op">=</span> <span class="va">ga</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gafit.gee</span><span class="op">)</span></pre></div>
<pre><code>## 
##  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
##  gee S-function, version 4.13 modified 98/01/27 (1998) 
## 
## Model:
##  Link:                      Identity 
##  Variance to Mean Relation: Gaussian 
##  Correlation Structure:     Exchangeable 
## 
## Call:
## gee::gee(formula = bweight ~ birthord, id = momid, data = ga, 
##     corstr = "exchangeable")
## 
## Summary of Residuals:
##       Min        1Q    Median        3Q       Max 
## -2795.464  -299.126    48.840   341.144  1824.536 
## 
## 
## Coefficients:
##             Estimate Naive S.E.   Naive z Robust S.E.  Robust z
## (Intercept) 2995.640  41.973695 71.369462   38.808066 77.191170
## birthord      46.608   9.958128  4.680398    9.996256  4.662546
## 
## Estimated Scale Parameter:  332525.3
## Number of Iterations:  1
## 
## Working Correlation
##           [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 1.0000000 0.4035684 0.4035684 0.4035684 0.4035684
## [2,] 0.4035684 1.0000000 0.4035684 0.4035684 0.4035684
## [3,] 0.4035684 0.4035684 1.0000000 0.4035684 0.4035684
## [4,] 0.4035684 0.4035684 0.4035684 1.0000000 0.4035684
## [5,] 0.4035684 0.4035684 0.4035684 0.4035684 1.0000000</code></pre>
</div>
<div id="correlation-assumptions-for-gee" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-assumptions-for-gee" class="anchor"></a>Correlation assumptions for GEE</h2>
<ul>
<li><p>Must make some assumption about the form of correlation among grouped observations</p></li>
<li>
<p>Independence</p>
<ul>
<li>no correlation between measurements within group</li>
</ul>
</li>
<li>
<p>Exchangeable</p>
<ul>
<li>all pairwise correlations are the same (in large-N limit)</li>
<li>nothing distinguishes one member of a cluster from another</li>
<li>appropriate in the absence of other data structures such as measurements taken through time or space</li>
</ul>
</li>
<li>
<p>Auto-regressive</p>
<ul>
<li>observations taken more closely in time are more highly correlated</li>
</ul>
</li>
</ul>
</div>
<div id="correlation-assumptions-for-gee-contd" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-assumptions-for-gee-contd" class="anchor"></a>Correlation assumptions for GEE (cont’d)</h2>
<ul>
<li>Unstructured
<ul>
<li>estimates a separate correlation between observations taken on each pair of “times”</li>
</ul>
</li>
<li>Non-stationary
<ul>
<li>similar to unstructured, but assumes all correlations for pairs separated far enough in time are zero</li>
</ul>
</li>
<li>Stationary
<ul>
<li>e.g. stationary of order 2: observations taken at time points 1 and 3 have the same correlation as time points 2 and 4</li>
<li>but this might be different from the correlation between observations taken at times 2 and 3</li>
<li>correlations for observations 3 or more time periods apart assumed to be zero</li>
</ul>
</li>
</ul>
<p><em>Fewer assumptions requires more data, and good assumptions improve results</em></p>
</div>
<div id="help-in-choosing-a-method" class="section level2">
<h2 class="hasAnchor">
<a href="#help-in-choosing-a-method" class="anchor"></a>Help in choosing a method</h2>
<div class="figure">
<img src="journal.pone.0146721.t002.PNG" alt=""><p class="caption">Hierarchical modeling decision table from Moen <em>et al.</em></p>
</div>
</div>
<div id="conclusions" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusions" class="anchor"></a>Conclusions</h2>
<ul>
<li>Ignoring within-subject correlations can produce very wrong results, and is not always “conservative”</li>
<li>Hierarchical analysis strategies are needed for any of:
<ol style="list-style-type: decimal">
<li>When the correlation structure is of primary interest, <em>e.g.</em> familial aggregation of disease, or consistency of treatment within centers,</li>
<li>When we wish to “borrow strength” across the levels of a hierarchy in order to improve estimates, and</li>
<li>When dealing with unbalanced correlated data. E.g., no requirement that each Georgia mother have exactly 5 children.</li>
</ol>
</li>
<li>Population average models provide a robust alternative to mixed models
<ul>
<li>for one level of hierarchy</li>
</ul>
</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://waldronlab.io">Levi Waldron</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
